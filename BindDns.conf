// ┌────────────────────────────────────────────────────────────┐
// │ Kea DNS Configuration                                      │
// │ Author: Paulo Fernandes                                    │
// │ Date: 2025-10-25                                           │
// │ Purpose: Configure BIND to serve DNS                       │
// └────────────────────────────────────────────────────────────┘

sudo dnf -y install bind bind-utils // Install BIND DNS server

acl internal-network {
    10.0.0.0/24;
}; // Define internal network

options {
    listen-on port 53 { any; };              // Listen on all IPv4 interfaces
    listen-on-v6 { any; };                   // Listen on all IPv6 interfaces (set to 'none' to disable)
    directory "/var/named";
    dump-file "/var/named/data/cache_dump.db";
    statistics-file "/var/named/data/named_stats.txt";
    memstatistics-file "/var/named/data/named_mem_stats.txt";
    secroots-file "/var/named/data/named.secroots";
    recursing-file "/var/named/data/named.recursing";

    allow-query { localhost; internal-network; };   // Allow DNS queries from localhost and internal network
    allow-transfer { localhost; };                  // Allow zone transfers to localhost (add secondaries if needed)

    recursion yes;
    dnssec-validation yes;

    managed-keys-directory "/var/named/dynamic";
    geoip-directory "/usr/share/GeoIP";

    pid-file "/run/named/named.pid";
    session-keyfile "/run/named/session.key";

    include "/etc/crypto-policies/back-ends/bind.config";
};

logging {
    channel default_debug {
        file "data/named.run";
        severity dynamic;
    };
};

// Forward zone for kalaustudio.com
zone "kalaustudio" IN {
    type primary;
    file "kalaustudio.com";
    allow-update { none; };
};

// Reverse zone for 10.0.0.0/24
zone "0.0.10.in-addr.arpa" IN {
    type primary;
    file "0.0.10.db";
    allow-update { none; };
};

// End of BIND DNS Configuration

sudo /etc/sysconfig/named// Edit this file to set BIND options
OPTIONS="-4" // Configure BIND to use only IPv4

// COnfigure zone files

sudo nano /var/named/0.0.10.db

$TTL 86400
@   IN  SOA     kalaustudio.com. root.kalaustudio.com. (
        ;; any numerical values are OK for serial number but
        ;; recommendation is [YYYYMMDDnn] (update date + number)
        2024122701  ;Serial
        3600        ;Refresh
        1800        ;Retry
        604800      ;Expire
        86400       ;Minimum TTL
)
        ;; define Name Server
        IN  NS      kalaustudio.com.
        ;; define Name Server's IP address
        IN  A       10.0.0.10
        ;; define Mail Exchanger Server
        IN  MX 10   kalaustudio.com.

;; define each IP address of a hostname
kalaustudio   IN  A       10.0.0.10


sudo nano /var/named/0.0.10.db
$TTL 86400
@   IN  SOA     kalaustudio.com. root.kalaustudio.com. (
        2024122701  ;Serial
        3600        ;Refresh
        1800        ;Retry
        604800      ;Expire
        86400       ;Minimum TTL
)
        ;; define Name Server
        IN  NS      kalaustudio.com.

;; define each hostname of an IP address
10      IN  PTR     kalaustudio.com.






